---
import type { ImageMetadata } from "astro"
import { getImage } from "astro:assets"

interface Props {
  backgroundImage?: ImageMetadata
  gradient?: string
  class?: string
}

const { backgroundImage, gradient, class: className } = Astro.props

// https://astro.build/blog/images/
const optimizedBackgroundImage =
  backgroundImage &&
  (await getImage({
    src: backgroundImage,
    quality: "max",
  }))

const image = `url('${optimizedBackgroundImage?.src}')`

const bgImg = [gradient, image].filter(Boolean).join(", ")
---

<section
  class:list={[
    "main-section w-full top-0 min-h-screen z-0 bg-cover bg-center bg-no-repeat flex pt-20",
    className,
  ]}
  style={`background-image: ${bgImg}`}
>
  <slot />
</section>
